
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Better Questions</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <style>
    #progress-bar {
      width: 100%;
      background-color: #eee;
      border-radius: 8px;
      margin-top: 20px;
      height: 20px;
    }
    #progress-fill {
      height: 100%;
      width: 0;
      background-color: #4caf50;
      border-radius: 8px;
      transition: width 0.5s ease;
    }
    #progress-label {
      font-weight: bold;
      margin-top: 10px;
    }
    #plaintext-output {
      display: none;
      margin-top: 15px;
    }
    .tool-buttons {
      margin-top: 15px;
    }
  </style>
</head>
<body>

  <h1>Better Questions</h1>

  <div class="warning-banner">
    ‚ö†Ô∏è <strong>Notice:</strong> If PubMed is currently down or under maintenance, Better Questions may return null results.
    Please try again later or check <a href="https://www.ncbi.nlm.nih.gov/" target="_blank">PubMed</a> directly.
  </div>

  <form method="POST" onsubmit="startProgress()">
    <label for="symptoms">Symptoms (comma-separated, max 3):</label><br>
    <input type="text" id="symptoms" name="symptoms" maxlength="150" placeholder="e.g., fatigue, dizziness, rash" required><br><br>

    <label for="conditions">Known Diagnoses (comma-separated, max 3):</label><br>
    <input type="text" id="conditions" name="conditions" maxlength="150" placeholder="e.g., lupus, fibromyalgia, anemia"><br><br>

    <input type="submit" value="Generate Questions">
  </form>

  <div id="progress-label"></div>
  <div id="progress-bar">
    <div id="progress-fill"></div>
  </div>

  {% if questions %}
    <div class="tool-buttons">
      <button onclick="window.print()">üñ® Print / Save as PDF</button>
      <button onclick="copyText()">üìã Copy All to Clipboard</button>
    </div>
    <div class="response-box">
      {{ questions[0]|safe }}
    </div>
    <textarea id="plaintext-output">{{ questions[2] }}</textarea>
  {% endif %}

  <div class="follow-links">
    <p>
      Follow on <a href="https://x.com/BetterToolsAI" target="_blank">@BetterToolsAI</a> &nbsp;|&nbsp;
      Read more at <a href="https://charlestools.substack.com" target="_blank">charlestools.substack.com</a>
    </p>
  </div>

  <footer>
    <p class="disclaimer-text">
      ‚ö†Ô∏è This tool does not provide medical advice or diagnoses. All results are generated from public literature. Always consult a licensed physician with any medical concerns.
    </p>
    <p class="mvp-note">
      This is an MVP. I build fast and validate before polish. If it‚Äôs useful, it grows. If not, it costs nothing.
    </p>
  </footer>

  <script>
    const stages = [
      "üîç Searching PubMed...",
      "üìä Running symptom-condition combinations...",
      "üß† Scoring and filtering articles...",
      "üìë Analyzing top articles...",
      "üìù Framing doctor questions..."
    ];

    function startProgress() {
      const label = document.getElementById("progress-label");
      const fill = document.getElementById("progress-fill");
      let i = 0;
      let width = 0;
      const interval = setInterval(() => {
        if (i < stages.length) {
          label.textContent = stages[i];
          width += 100 / stages.length;
          fill.style.width = width + "%";
          i++;
        } else {
          clearInterval(interval);
        }
      }, 1000);
    }

    function copyText() {
      const textArea = document.getElementById("plaintext-output");
      textArea.style.display = "block";
      textArea.select();
      textArea.setSelectionRange(0, 99999);
      navigator.clipboard.writeText(textArea.value).then(() => {
        alert("Copied to clipboard! You can paste it into a document or email.");
      });
    }
  </script>

</body>
</html>
